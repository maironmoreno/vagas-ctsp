<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Movimenta√ß√£o CBMRS 2026</title>
    
    <!-- √çcone da aba (Favicon) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöí</text></svg>">

    <!-- Tratamento de Erros Global -->
    <script>
        window.addEventListener('error', function(e) {
            const errorBox = document.getElementById('error-box');
            if (errorBox) {
                errorBox.style.display = 'flex';
                document.getElementById('error-message').innerText = 
                    "Erro: " + e.message + "\n\nSe estiver no GitHub Pages, verifique se configurou o Firebase corretamente no c√≥digo.";
            }
        });
    </script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        .animate-pulse-slow { animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        #error-box { display: none; }
    </style>
</head>
<body>
    <!-- Caixa de Erro Vis√≠vel -->
    <div id="error-box" class="fixed inset-0 z-50 items-center justify-center bg-black bg-opacity-90 text-white p-8 hidden">
        <div class="bg-red-900 p-6 rounded-xl max-w-2xl w-full border border-red-500 shadow-2xl">
            <h2 class="text-2xl font-bold mb-4">‚ö†Ô∏è Erro de Execu√ß√£o</h2>
            <pre id="error-message" class="bg-black bg-opacity-50 p-4 rounded text-sm overflow-auto mb-4 font-mono"></pre>
            <button onclick="window.location.reload()" class="bg-white text-red-900 px-4 py-2 rounded font-bold hover:bg-gray-200">Recarregar P√°gina</button>
        </div>
    </div>

    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, doc, setDoc, onSnapshot, query } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const { useState, useEffect, useMemo } = React;

        // --- DADOS ---
        const VAGAS_DATA = [
            { cidade: "N√£o irei escolher", vagas: 9999 },
            { cidade: "Porto Alegre", vagas: 36 }, { cidade: "S√£o Leopoldo", vagas: 15 },
            { cidade: "Triunfo", vagas: 3 }, { cidade: "Dois Irm√£os", vagas: 1 },
            { cidade: "Port√£o", vagas: 2 }, { cidade: "Novo Hamburgo", vagas: 3 },
            { cidade: "Pelotas", vagas: 6 }, { cidade: "Rio Grande", vagas: 5 },
            { cidade: "Santa Vit√≥ria do Palmar", vagas: 2 }, { cidade: "Santa Maria", vagas: 17 },
            { cidade: "J√∫lio de Castilhos", vagas: 3 }, { cidade: "Ca√ßapava do Sul", vagas: 3 },
            { cidade: "S√£o Sep√©", vagas: 1 }, { cidade: "Caxias do Sul", vagas: 22 },
            { cidade: "S√£o Marcos", vagas: 1 }, { cidade: "Taquara", vagas: 2 },
            { cidade: "Veran√≥polis", vagas: 2 }, { cidade: "Lagoa Vermelha", vagas: 1 },
            { cidade: "Vacaria", vagas: 2 }, { cidade: "Gramado", vagas: 2 },
            { cidade: "Bento Gon√ßalves", vagas: 1 }, { cidade: "Gua√≠ba", vagas: 1 },
            { cidade: "Rio Pardo", vagas: 1 }, { cidade: "S√£o Louren√ßo do Sul", vagas: 2 },
            { cidade: "S√£o Jer√¥nimo", vagas: 1 }, { cidade: "Camaqu√£", vagas: 1 },
            { cidade: "Vera Cruz", vagas: 1 }, { cidade: "Ven√¢ncio Aires", vagas: 1 },
            { cidade: "Passo Fundo", vagas: 12 }, { cidade: "Guapor√©", vagas: 2 },
            { cidade: "Erechim", vagas: 8 }, { cidade: "Nonoai", vagas: 1 },
            { cidade: "Soledade", vagas: 1 }, { cidade: "Get√∫lio Vargas", vagas: 2 },
            { cidade: "Carazinho", vagas: 3 }, { cidade: "Tapera", vagas: 2 },
            { cidade: "Sarandi", vagas: 3 }, { cidade: "Canoas", vagas: 9 },
            { cidade: "Viam√£o", vagas: 1 }, { cidade: "Alvorada", vagas: 1 },
            { cidade: "Tramanda√≠", vagas: 5 }, { cidade: "Cap√£o da Canoa", vagas: 1 },
            { cidade: "Terra de Areia", vagas: 1 }, { cidade: "Santana do Livramento", vagas: 3 },
            { cidade: "Quara√≠", vagas: 1 }, { cidade: "Dom Pedrito", vagas: 1 },
            { cidade: "Bag√©", vagas: 1 }, { cidade: "Ibirub√°", vagas: 1 },
            { cidade: "Palmeira das Miss√µes", vagas: 1 }, { cidade: "Frederico Westphalen", vagas: 2 },
            { cidade: "Uruguaiana", vagas: 2 }, { cidade: "Barra do Quara√≠", vagas: 1 },
            { cidade: "Santiago", vagas: 2 }
        ];

        const SARGENTOS_DATA = [
            { id: "2877953", nome: "EDGAR DA SILVA GODINHO", ant: 307, lotacao: "2¬∫ CRBM-5¬∞ BBM - Vacaria" },
            { id: "2910233", nome: "VINICIUS MACHADO DE MORAES", ant: 310, lotacao: "4¬∞ CRBM-6¬∞ BBM - S√£o Louren√ßo do Sul" },
            { id: "2919192", nome: "ROSEANE VERA MILITZ CARVALHO", ant: 311, lotacao: "2¬∫ CRBM-7¬∫ BBM - Passo Fundo" },
            { id: "2911400", nome: "FRANCISCO DELMAR LANZ JUNIOR", ant: 313, lotacao: "2¬∫ CRBM-2¬∫ BBM - Parob√©" },
            { id: "2919060", nome: "EDUARDO DA ROSA MARTINS", ant: 316, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "2918960", nome: "ADRIANO ALMEIDA LARRONDO", ant: 321, lotacao: "4¬∞ CRBM-4¬∞ BBM Cachoeira do Sul" },
            { id: "2919150", nome: "MOIS√âS SANTOS DA SILVA", ant: 324, lotacao: "3¬∫ CRBM-3¬∫ BBM - Rio Grande" },
            { id: "2910527", nome: "LUIS FERNANDO BARRAGAN FERREIRA", ant: 325, lotacao: "3¬∫ CRBM-3¬∫ BBM - Cangu√ßu" },
            { id: "2919249", nome: "JOSE ADAO DIAS NEVES", ant: 326, lotacao: "3¬∫ CRBM-10¬∞ BBM - Quara√≠" },
            { id: "2915650", nome: "JEAN DE FREITAS NUNES", ant: 330, lotacao: "3¬∫ CRBM-13¬∫ BBM - S√£o Borja" },
            { id: "2918650", nome: "FLAVIO HEINRICH", ant: 331, lotacao: "4¬∞ CRBM-6¬∞ BBM Santa Cruz do Sul" },
            { id: "2914077", nome: "MAURO CESAR BATISTA BUENO", ant: 332, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "2915804", nome: "LEANDRO DOS SANTOS ESP√çNDULA", ant: 333, lotacao: "1¬∫ CRBM-9¬∫ BBM - Os√≥rio" },
            { id: "2917947", nome: "FRANCKLIN DOUGLAS RIBEIRO DO AMARAL", ant: 334, lotacao: "1¬∫ CRBM-9¬∫ BBM - Os√≥rio" },
            { id: "2919478", nome: "FAUSTO FARIAS DOS SANTOS", ant: 335, lotacao: "1¬∫ CRBM-1¬∫ BBM - Porto Alegre" },
            { id: "2919346", nome: "FRANCIONE BECKER", ant: 336, lotacao: "4¬∫ CRBM-11¬∞ BBM - Santo √Çngelo" },
            { id: "2969939", nome: "DAIR GUTOWSKI", ant: 337, lotacao: "2¬∫ CRBM-7¬∞ BBM - Erechim" },
            { id: "2968614", nome: "PAULO VAGNER PERUZZI AZOLIN", ant: 338, lotacao: "4¬∞ CRBM-11¬∫ BBM - S√£o Luiz Gonzaga" },
            { id: "2970414", nome: "JO√ÉO MARCOS PETERSEN OLIVEIRA", ant: 343, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "2969424", nome: "ADRIANO IENSEN PENDEZA", ant: 345, lotacao: "4¬∞ CRBM-4¬∞ BBM Santa Maria" },
            { id: "2788403", nome: "DANIEL LIMA LAGEMANN", ant: 346, lotacao: "4¬∫ CRBM-4¬∞ BBM - Restinga S√™ca" },
            { id: "2973588", nome: "MAIQUER PERES COUTO", ant: 347, lotacao: "3¬∫ CRBM-10¬∞ BBM - Bag√©" },
            { id: "2968410", nome: "ALAN DIONES DA SILVA PAIM", ant: 348, lotacao: "2¬∫ CRBM-5¬∞ BBM - Vacaria" },
            { id: "2969580", nome: "JOAO CARLOS SILVA CARPES", ant: 349, lotacao: "3¬∫ CRBM-13¬∫ BBM - S√£o Borja" },
            { id: "2969912", nome: "DENER LEMOS CORREA", ant: 350, lotacao: "3¬∫ CRBM-10¬∞ BBM - Dom Pedrito" },
            { id: "2969289", nome: "VANDER VIEIRA RODRIGUES", ant: 351, lotacao: "2¬∫ CRBM-5¬∫ BBM - Farroupilha" },
            { id: "2974223", nome: "CESAR MALET RODRIGUES", ant: 352, lotacao: "1¬∫ CRBM-9¬∞ BBM - Santo Ant√¥nio da Patrulha" },
            { id: "2969459", nome: "ANDRE STRINGHI MARQUES", ant: 354, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "2973871", nome: "ELISETE DE FATIMA DORNELES ANTUNES", ant: 355, lotacao: "1¬∫ CRBM-9¬∞ BBM - Tramanda√≠" },
            { id: "2857170", nome: "ANDERSON DE OLIVEIRA PEREIRA", ant: 356, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "2971577", nome: "JULIANO BARREIRO QUIRINO", ant: 358, lotacao: "1¬∫ CRBM-1¬∫ BBM - Porto Alegre" },
            { id: "2968258", nome: "ODAIR DOS SANTOS DORNELLES", ant: 359, lotacao: "2¬∫ CRBM-2¬∫ BBM - Sapiranga" },
            { id: "2972794", nome: "EMERSON ALVES GOMES", ant: 360, lotacao: "3¬∫ CRBM-3¬∫ BBM - S√£o Jos√© do Norte" },
            { id: "2973278", nome: "EBERSON CORREA DA SILVA", ant: 362, lotacao: "1¬∫ CRBM-9¬∞ BBM - Cap√£o da Canoa" },
            { id: "2971763", nome: "ROBERTO JOSE PIREZ EPIFANIO FILHO", ant: 363, lotacao: "4¬∫ CRBM-6¬∞ BBM - Lajeado" },
            { id: "2916797", nome: "DIEGO DA SILVA", ant: 364, lotacao: "4¬∞ CRBM-4¬∞ BBM Cachoeira do Sul" },
            { id: "2992663", nome: "EVANDRO ŒëŒùŒ§ŒüŒùŒôŒü HENZ", ant: 367, lotacao: "4¬∞ CRBM-6¬∞ BBM - Estrela" },
            { id: "2821834", nome: "RODRIGO PIRES DA SILVA", ant: 368, lotacao: "4¬∞ CRBM-6¬∞ BBM - Estrela" },
            { id: "2996677", nome: "BERNARDO GOTTWALD", ant: 369, lotacao: "4¬∞ CRBM-11¬∫ BBM - Tr√™s Passos" },
            { id: "2995808", nome: "TIAGO ARTUR ROHLEDER", ant: 370, lotacao: "2¬∫ CRBM-2¬∫ BBM - Sapiranga" },
            { id: "2993775", nome: "JOSE FELIPE DE ASSUMPCAO MARINHO", ant: 371, lotacao: "1¬∫ CRBM-9¬∞ BBM-Santo Ant√¥nio da Patrulha" },
            { id: "2995506", nome: "SIDNEI SEVERO DA SILVA", ant: 372, lotacao: "4¬∞ CRBM-4¬∫ BBM Santa Maria" },
            { id: "2991926", nome: "DERLI DA CRUZ RIOS", ant: 373, lotacao: "4¬∞ CRBM-11¬∫ BBM - S√£o Luiz Gonzaga" },
            { id: "2992825", nome: "ALESSANDRO SOARES CASTRO", ant: 374, lotacao: "4¬∞ CRBM-6¬∞ BBM-Gua√≠ba" },
            { id: "2786958", nome: "ARMANDO FREITAS SALDANHA", ant: 375, lotacao: "4¬∞ CRBM-4¬∫ BBM Santa Maria" },
            { id: "2825732", nome: "MARCOS DE PAULA CAMARGO", ant: 378, lotacao: "4¬∞ CRBM-11¬∫ BBM Santa Rosa" },
            { id: "2991322", nome: "AURELIO JUAREZ RODRIGUES", ant: 380, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "2995093", nome: "ROBERSON PERES CABRAL", ant: 381, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "2995840", nome: "VANISE SCHNEIDER", ant: 382, lotacao: "4¬∞ CRBM-11¬∫ BBM - Tr√™s de Maio" },
            { id: "2993872", nome: "JUNIOR MARQUES DE MARQUES", ant: 384, lotacao: "4¬∞ CRBM-4¬∞ BBM - Ca√ßapava do Sul" },
            { id: "2992930", nome: "CRISTIANO WILLIAM SOUZA", ant: 388, lotacao: "2¬∫ CRBM-7¬∫ BBM - Passo Fundo" },
            { id: "2993112", nome: "DIENESON TOLDO DE BARROS", ant: 390, lotacao: "2¬∫ CRBM-7¬∫ BBM - Passo Fundo" },
            { id: "2994291", nome: "MARIA MEDIANEIRA DOS SANTOS", ant: 391, lotacao: "4¬∞ CRBM-6¬∞ BBM - Vera Cruz" },
            { id: "2994305", nome: "MAICON MULLER SCHMITT", ant: 393, lotacao: "4¬∞ CRBM-4¬∫ BBM-Santa Maria" },
            { id: "2993430", nome: "JONY CAZAUBON DA SILVA", ant: 394, lotacao: "2¬∫ CRBM-5¬∞ BBM Bento Gon√ßalves" },
            { id: "2994976", nome: "RAFAEL RELINGUE RODRIGUES", ant: 395, lotacao: "3¬∫ CRBM-10¬∞ BBM Dom Pedrito" },
            { id: "2993945", nome: "JAKSON RODRIGO MELO", ant: 396, lotacao: "2¬∫ CRBM-7¬∞ BBM - Soledade" },
            { id: "2994364", nome: "MARNEN CABREIRA DE SOUZA", ant: 398, lotacao: "3¬∫ CRBM-3¬∫ BBM Santa Vit√≥ria do Palmar" },
            { id: "2994500", nome: "LEANDRO TEIXEIRA NUNES", ant: 399, lotacao: "1¬∫ CRBM-1¬∫ BBM - Porto Alegre" },
            { id: "3058417", nome: "JUARES ROBERTO KAISEKAMP", ant: 400, lotacao: "1¬∫ CRBM-8¬∞ BBM - Sapucaia do Sul" },
            { id: "2993651", nome: "JULIO FRANCISCO HAITO", ant: 401, lotacao: "2¬∫ CRBM-5¬∞ BBM Caxias do Sul" },
            { id: "2993848", nome: "JOHNATHAN RAMON SANTOS PEREIRA", ant: 402, lotacao: "4¬∞ CRBM-6¬∞ BBM - Lajeado" },
            { id: "2784947", nome: "ELISANDRO STELLO ZIEGLER", ant: 403, lotacao: "4¬∞ CRBM-4¬∫ BBM Santa Maria" },
            { id: "2856425", nome: "PAULO ANTONIO RODRIGUES DOS SANTOS JUNIOR", ant: 404, lotacao: "2¬∫ CRBM-5¬∞ BBM Caxias do Sul" },
            { id: "2993961", nome: "LUCIANO DIAS KULMANN", ant: 407, lotacao: "3¬∫ CRBM-13¬∫ BBM - Itaqui" },
            { id: "2994640", nome: "MARIANE PIRES MOLINA", ant: 408, lotacao: "3¬∫ CRBM-10¬∫ BBM - S√£o Gabriel" },
            { id: "3144941", nome: "LEANDRO NUNES SAIKOSKI", ant: 412, lotacao: "1¬∫ CRBM-9¬∞ BBM Santo Ant√¥nio da Patrulha" },
            { id: "3155048", nome: "JONATAN HARTMANN", ant: 413, lotacao: "2¬∫ CRBM-5¬∞ BBM - Farroupilha" },
            { id: "3144054", nome: "GELLIARD LINHAR DE SOUZA", ant: 417, lotacao: "3¬∫ CRBM-3¬∫ BBM - S√£o Jos√© do Norte" },
            { id: "3135780", nome: "JEISON JAIR RODRIGUES SCALCON", ant: 418, lotacao: "3¬∫ CRBM-10¬∞ BBM-Ros√°rio do Sul" },
            { id: "2870720", nome: "CRISTIAN DE LIMA FRANCO", ant: 419, lotacao: "1¬∫ CRBM-EM - Porto Alegre" },
            { id: "3153525", nome: "IGOR LEMOES XAVIER", ant: 422, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "3136078", nome: "ROGER RISSON DA SILVA", ant: 423, lotacao: "DA/DTIC - Porto Alegre" },
            { id: "3154920", nome: "JULIANO ANTONIO CAPA DOS REIS", ant: 424, lotacao: "2¬∫ CRBM-2¬∫ BBM - Montenegro" },
            { id: "3147800", nome: "RICARDO PORTO DORNELES", ant: 426, lotacao: "2¬∫ CRBM-2¬∫ BBM - Ivoti" },
            { id: "3166619", nome: "BRUNO DA COSTA SILVA MENEZES", ant: 428, lotacao: "2¬∫ CRBM-7¬∫ BBM - Passo Fundo" },
            { id: "3161706", nome: "ENO GALITO DA SILVA", ant: 429, lotacao: "3¬∫ CRBM-13¬∞ BBM - Santiago" },
            { id: "3152677", nome: "ALEXANDRE SCHIFELBEIN", ant: 432, lotacao: "2¬∫ CRBM-5¬∞ BBM Bento Gon√ßalves" },
            { id: "3152375", nome: "BRUNO BRANDOLT PEDROSO", ant: 433, lotacao: "3¬∫ CRBM-13¬∞ BBM - Alegrete" },
            { id: "2871653", nome: "JUNIR SCESNY", ant: 434, lotacao: "2¬∫ CRBM-7¬∫ BBM - Erechim" },
            { id: "3147657", nome: "CLEBER ESPINDOLA DA SILVA", ant: 436, lotacao: "1¬∫ CRBM-9¬∞ BBM - Terra de Areia" },
            { id: "2956659", nome: "MARCELO NORNBERG BERGMANN", ant: 439, lotacao: "3¬∫ CRBM-3¬∫ BBM - Pelotas" },
            { id: "3157113", nome: "LUCIAN ALVES INSAURRIAGA", ant: 440, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "3138054", nome: "AIRTON DA SILVA VIEIRA JUNIOR", ant: 441, lotacao: "1¬∫ CRBM-8¬∞ BBM - Alvorada" },
            { id: "2824361", nome: "ROGER DA SILVA BEHLING", ant: 442, lotacao: "3¬∫ CRBM-13¬∫ BBM - S√£o Borja" },
            { id: "2959879", nome: "DOUGLAS DOS SANTOS CAVALEIRO", ant: 443, lotacao: "1¬∫ CRBM-9¬∫ BBM - Cap√£o da Canoa" },
            { id: "3147576", nome: "MAURICIO CHAVES DOS SANTOS", ant: 451, lotacao: "2¬∫ CRBM-2¬∫ BBM - Ivoti" },
            { id: "3164853", nome: "HORIZONTE DE JESUS AGUIRRE JUNIOR", ant: 452, lotacao: "2¬∫ CRBM-2¬∞ BBM - Parob√©" },
            { id: "3154742", nome: "ISMAEL LAZO DE OLIVEIRA", ant: 453, lotacao: "3¬∫ CRBM-3¬∫ BBM - Santa Vit√≥ria do Palmar" },
            { id: "2987490", nome: "MAIRON GOULART MOREO", ant: 454, lotacao: "3¬∫ CRBM-3¬∫ BBM - Jaguar√£o" },
            { id: "3153770", nome: "NATALIA DA CRUZ ANGRIZANO PISKE", ant: 456, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "3137058", nome: "RAFAEL STACHACK", ant: 457, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "3135837", nome: "SIDINEI MENDONCA", ant: 458, lotacao: "1¬∫ CRBM-9¬∞ BBM - Tramanda√≠" },
            { id: "3137562", nome: "NERISSON LENHARDT WESZ", ant: 459, lotacao: "2¬∫ CRBM-2¬∫ BBM - Dois Irm√£os" },
            { id: "2871980", nome: "DELIR ANDR√â DOS SANTOS PESSOTA", ant: 460, lotacao: "1¬∫ CRBM-1¬∫ BBM - Porto Alegre" },
            { id: "3143031", nome: "FERNANDO FEYH", ant: 461, lotacao: "4¬∫ CRBM-6¬∞ BBM - Estrela" },
            { id: "2824019", nome: "ACY DA SILVA UMPIERRE NETO", ant: 462, lotacao: "4¬∫ CRBM-4¬∞ BBM - Ca√ßapava do Sul" },
            { id: "3165779", nome: "RAFAEL LUCCHESE BORGMANN", ant: 463, lotacao: "4¬∞ CRBM-6¬∞ BBM-Vera Cruz" },
            { id: "3146898", nome: "MARCOS APARECIDO DA LUZ", ant: 465, lotacao: "2¬∫ CRBM-5¬∞ BBM - Farroupilha" },
            { id: "3158900", nome: "RUDRI ANGELO PETRY DOS SANTOS", ant: 466, lotacao: "1¬∫ CRBM-9¬∞ BBM Santo Ant√¥nio da Patrulha" },
            { id: "3151581", nome: "VALMIR DA ROSA SARUBA", ant: 467, lotacao: "2¬∫ CRBM-5¬∞ BBMCaxias do Sul" },
            { id: "2871017", nome: "ANDRE LUIS VASILUK", ant: 468, lotacao: "2¬∫ CRBM-7¬∞ BBM - Erechim" },
            { id: "3695450", nome: "CRISTIAN BAUER DE MORAES", ant: 469, lotacao: "4¬∞ CRBM-4¬∞ BBM Cachoeira do Sul" },
            { id: "3697487", nome: "GUILHERME ANDRE OLKOSKI DA SILVA", ant: 470, lotacao: "2¬∫ CRBM-2¬∫ BBM - Sapiranga" },
            { id: "3698505", nome: "VANDERLAN MORAIS ANDRADE", ant: 474, lotacao: "3¬∫ CRBM-13¬∫ BBM - S√£o Borja" },
            { id: "3696596", nome: "FERNANDO BELGRAVO KOHAUT DA SILVA", ant: 475, lotacao: "2¬∫ CRBM-7¬∞ BBM Carazinho" },
            { id: "2985675", nome: "DIEGO ROSA BOTEGA", ant: 476, lotacao: "1¬∫ CRBM-1¬∞ BBM - Porto Alegre" },
            { id: "3695719", nome: "PAULO ROBERTO JUNIOR DA SILVA RIBEIRO", ant: 479, lotacao: "3¬∫ CRBM-10¬∞ BBM - Quara√≠" },
            { id: "3699358", nome: "HUESLEI ALVARENGA BERCHON", ant: 480, lotacao: "2¬∫ CRBM-2¬∫ BBM - S√£o Leopoldo" },
            { id: "3694577", nome: "CRISTIANE ELISA BIEGER ANDRADE", ant: 481, lotacao: "4¬∫ CRBM-11¬∫ BBM - S√£o Luiz Gonzaga" },
            { id: "3696197", nome: "ELVIS DOS ANJOS SILVA", ant: 483, lotacao: "4¬∞ CRBM-4¬∞ BBM Santa Maria" },
            { id: "3203212", nome: "LUCAS BRUM GUEDES", ant: 485, lotacao: "2¬∫ CRBM-5¬∞ BBM - Gramado" },
            { id: "3695565", nome: "WILLIAM LICHT DOS SANTOS", ant: 487, lotacao: "1¬∫ CRBM-9¬∞ BBM - Torres" },
            { id: "3694810", nome: "FELIPE VARGAS OLIVEIRA", ant: 488, lotacao: "4¬∫ CRBM-6¬∞ BBM - Santa Cruz do Sul" },
            { id: "3698530", nome: "RAFAEL LISCANO", ant: 491, lotacao: "3¬∫ CRBM-3¬∫ BBM - Jaguar√£o" },
            { id: "3694607", nome: "VAGNER ANTONIO CARDOSO MEREGALLI", ant: 493, lotacao: "1¬∫ CRBM-9¬∞ BBM - Cidreira" },
            { id: "3697479", nome: "CESAR AUGUSTO CHRISTMANN", ant: 495, lotacao: "4¬∫ CRBM-6¬∞ BBM Santa Cruz do Sul" },
            { id: "3697908", nome: "JOAO GABRIEL GRANDO GUEDES", ant: 497, lotacao: "2¬∫ CRBM-7¬∞ BBM Soledade" },
            { id: "3695433", nome: "MAIKEL NUNES MARQUARDT", ant: 498, lotacao: "4¬∫ CRBM-6¬∞ BBM Santa Cruz do Sul" },
            { id: "3695735", nome: "MURILO MIGUEL SCHMITZ", ant: 499, lotacao: "3¬∫ CRBM-13¬∫ BBM - Santiago" },
            { id: "3203476", nome: "MARCIANO DA SILVA BUENO", ant: 500, lotacao: "2¬∫ CRBM-5¬∞ BBM Bento Gon√ßalves" },
            { id: "3698750", nome: "JANDER DA SILVA MARQUES", ant: 501, lotacao: "4¬∞ CRBM-6¬∫ BBM - S√£o Jer√¥nimo" },
            { id: "3697134", nome: "VICTOR MATHEUS DA GAMA GULARTE", ant: 502, lotacao: "3¬∫ CRBM-3¬∫ BBM Santa Vit√≥ria do Palmar" },
            { id: "3696367", nome: "VIRGILIO HENRIQUE LUZZI", ant: 503, lotacao: "4¬∫ CRBM-6¬∞ BBM - Lajeado" },
            { id: "3698963", nome: "REGIS DUTRA CARDOSO", ant: 504, lotacao: "4¬∞ CRBM-12¬∞ BBM-Cruz Alta" },
            { id: "3697320", nome: "WILLIAM RODRIGO SILVA DE OLIVEIRA", ant: 505, lotacao: "3¬∫ CRBM-3¬∫ BBM - Jaguar√£o" },
            { id: "3704343", nome: "JULIANO SOARES SODRE", ant: 510, lotacao: "1¬∫ CRBM-EM - Porto Alegre" },
            { id: "3706028", nome: "ALINE FRANCIELE SCHIEFELBEIN", ant: 511, lotacao: "2¬∫ CRBM-2¬∫ BBM - Port√£o" },
            { id: "3717070", nome: "MAICON OLIVEIRA RIBEIRO", ant: 512, lotacao: "4¬∞ CRBM-6¬∞ BBM Santa Cruz do Sul" },
            { id: "4289137", nome: "JAIME JOSE REIS JUNIOR", ant: 514, lotacao: "1¬∫ CRBM-9¬∞ BBM - Cap√£o da Canoa" },
            { id: "4289196", nome: "THIAGO DO AMARAL", ant: 515, lotacao: "2¬∫ CRBM-2¬∫ BBM - Est√¢ncia Velha" },
            { id: "4289188", nome: "WAGNER GON√áALVES LIMA", ant: 516, lotacao: "1¬∫ CRBM-8¬∞ BBM - Sapucaia do Sul" },
            { id: "4289218", nome: "ALEXANDRE DANIEL SCHRODER", ant: 518, lotacao: "4¬∞ CRBM-11¬∞ BBM-Giru√°" },
            { id: "4354001", nome: "DOUGLAS MACIEL SILVEIRA", ant: 519, lotacao: "4¬∞ CRBM-6¬∞ BBM-Santa Cruz do Sul" },
            { id: "4354427", nome: "DIONATAN MENEN LUIS DA ROSA MACHADO", ant: 520, lotacao: "4¬∞ CRBM-4¬∞ BBM - Ca√ßapava do Sul" },
            { id: "4355083", nome: "DAIANE DA SILVEIRA", ant: 521, lotacao: "2¬∫ CRBM-2¬∞ BBM - Novo Hamburgo" },
            { id: "4353781", nome: "MARCO AURELIO TOMIELLO ROCHA", ant: 523, lotacao: "1¬∫ CRBM-1¬∫ BBM - Porto Alegre" },
            { id: "4354354", nome: "ROGER PIRES DA SILVA", ant: 525, lotacao: "2¬∫ CRBM-2¬∫ BBM - Est√¢ncia Velha" },
            { id: "3715361", nome: "NICOLAS MATOS DIAS DE CASTRO", ant: 526, lotacao: "1¬∫ CRBM-9¬∞ BBM-Tramanda√≠" },
            { id: "4355350", nome: "VINICIUS CARLOS SCHIRMER", ant: 527, lotacao: "2¬∫ CRBM-5¬∞ BBM - Taquara" },
            { id: "4354958", nome: "LUCAS CRUMMENAUER", ant: 529, lotacao: "4¬∞ CRBM-12¬∞ BBM - Panambi" },
            { id: "3736539", nome: "DOUGLAS FABRICIO SEIBT", ant: 531, lotacao: "4¬∞ CRBM-6¬∫ BBM - Ven√¢ncio Aires" },
            { id: "4355814", nome: "RAGNER SILVA DOS REIS", ant: 532, lotacao: "2¬∫ CRBM-5¬∞ BBM - Vacaria" },
            { id: "4354486", nome: "ITAIRAN DA SILVA QUARESMA", ant: 533, lotacao: "4¬∞ CRBM-11¬∞ BBM-Giru√°" },
            { id: "4354524", nome: "EBERSON CORREA DA SILVA", ant: 534, lotacao: "4¬∞ CRBM-12¬∞ BBM Ibirub√°" },
            { id: "4355563", nome: "OLAVIO VALERIO FLESCH GON√áALVES", ant: 536, lotacao: "2¬∫ CRBM-2¬∫ BBM Novo Hamburgo" },
            { id: "4354117", nome: "FABRICIO AMORIM MACHADO", ant: 537, lotacao: "1¬∫ CRBM-8¬∞ BBM Nova Santa Rita" },
            { id: "4355431", nome: "EMERSON LUIS MAIA DA ROSA", ant: 538, lotacao: "4¬∫ CRBM-12¬∞ BBM - Cruz Alta" },
            { id: "4354567", nome: "LEANDRO BAQUES RESTA", ant: 539, lotacao: "2¬∫ CRBM-7¬∞ BBM Soledade" },
            { id: "4356039", nome: "CASSIANO DE ALMEIDA FAVA", ant: 540, lotacao: "2¬∫ CRBM-7¬∞ BBM - Erechim" },
            { id: "4355237", nome: "JOHN ELVIS NOGUEIRA", ant: 541, lotacao: "2¬∫ CRBM-2¬∫ BBM - Parob√©" },
            { id: "4354214", nome: "LUIZ ANTONIO AVILA CHAVES", ant: 543, lotacao: "2¬∫ CRBM-7¬∞ BBM Soledade" },
            { id: "4355849", nome: "EZEQUIEL DE AVILLA", ant: 544, lotacao: "4¬∞ CRBM-4¬∞ BBM Santa Maria" },
            { id: "4354141", nome: "RICARDO ANKLAM", ant: 545, lotacao: "4¬∫ CRBM-11¬∫ BBM - Santo Angelo" },
            { id: "4387848", nome: "DIOGO DA SILVA DE OLIVEIRA", ant: 546, lotacao: "2¬∫ CRBM-5¬∞ BBM-Gramado" },
            { id: "4388194", nome: "PEDRO GIOVANE CAMARGO MARTINS", ant: 547, lotacao: "4¬∫ CRBM-12¬∞ BBM - Cruz Alta" },
            { id: "4388313", nome: "BRUNO PARABONI FIORIN", ant: 548, lotacao: "4¬∞ CRBM-4¬∫ BBM - J√∫lio de Castilhos" },
            { id: "4387880", nome: "ALCIONE SIBULSKI", ant: 551, lotacao: "4¬∞ CRBM-11¬∫ BBM-Giru√°" },
            { id: "4388429", nome: "MATEUS VINICIUS GOBATTO", ant: 552, lotacao: "2¬∫ CRBM-5¬∞ BBM Bento Gon√ßalves" },
            { id: "4387732", nome: "ADRIEL KAREL PACHECO DE MELLO", ant: 553, lotacao: "2¬∫ CRBM-2¬∫ BBM - Parob√©" },
            { id: "4387791", nome: "ARTHUR FARIAS MARTINS", ant: 554, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "4395590", nome: "GABRIEL HOCHSCHEIDT", ant: 556, lotacao: "4¬∞ CRBM-11¬∫ BBM - Tr√™s de Maio" },
            { id: "4395808", nome: "FERNANDO LUCIAN SAUSEN AVILA", ant: 557, lotacao: "2¬∫ CRBM-5¬∞ BBM Flores da Cunha" },
            { id: "4395123", nome: "FELIPE PEREIRA DA SILVA", ant: 558, lotacao: "4¬∞ CRBM-6¬∞ BBM Santa Cruz do Sul" },
            { id: "4395247", nome: "FRANCISCO DE PAULA COLOMBY SIMOES", ant: 559, lotacao: "4¬∫ CRBM-6¬∞ BBM - CamaquƒÅ" },
            { id: "4395654", nome: "GENIANE NASCENTE DE OLIVEIRA", ant: 560, lotacao: "4¬∞ CRBM-6¬∞ BBM-Santa Cruz do Sul" },
            { id: "4354320", nome: "MAURICIO LEITE DE FARIAS JUNIOR", ant: 562, lotacao: "2¬∫ CRBM-2¬∫ BBM - Est√¢ncia Velha" },
            { id: "4550161", nome: "SAMUEL MATEUS BRENTANO", ant: 566, lotacao: "2¬∫ CRBM-2¬∫ BBM - Novo Hamburgo" },
            { id: "4550412", nome: "FELIPE COSTA LOPES", ant: 567, lotacao: "4¬∞ CRBM-4¬∫ BBM - S√£o Pedro do Sul" },
            { id: "4550714", nome: "ANTHONY GUTERRES DA SILVA", ant: 568, lotacao: "3¬∫ CRBM-3¬∫ BBM Pelotas" },
            { id: "4550277", nome: "RICARDO RAFAEL WERLANG", ant: 571, lotacao: "1¬∫ CRBM-EM - Porto Alegre" },
            { id: "4550730", nome: "TA√çS NAIELE HETTWER", ant: 573, lotacao: "2¬∫ CRBM-7¬∫ BBM - Passo Fundo" },
            { id: "4550692", nome: "RICARDO BUENO MION", ant: 574, lotacao: "4¬∫ CRBM-11¬∞ BBM - Santo √Çngelo" },
            { id: "4550471", nome: "HALLAN LOPES GUEDES", ant: 575, lotacao: "4¬∞ CRBM-6¬∞ BBM - Lajeado" },
            { id: "4549724", nome: "DANIEL BRUGNERA ACOSTA", ant: 579, lotacao: "1¬∫ CRBM-9¬∞ BBM Santo Ant√¥nio da Patrulha" },
            { id: "4549694", nome: "ARCE DE LE√ìN BOTELHA GOTTLIEB", ant: 582, lotacao: "2¬∫ CRBM-2¬∞ BBM - Parob√©" },
            { id: "4549970", nome: "JOHNNY PIRES GODOŒ•", ant: 587, lotacao: "2¬∫ CRBM-5¬∞ BBM - Farroupilha" },
            { id: "4550145", nome: "JO√ÉO PEDRO DE MOURA GARCIA SANTELLI", ant: 588, lotacao: "2¬∫ CRBM-5¬∞ BBMCaxias do Sul" },
            { id: "4549902", nome: "GILIARDI SANTOS MAZUI", ant: 591, lotacao: "3¬∫ CRBM-13¬∞ BBM - Alegrete" },
            { id: "4550463", nome: "HIAGO MALDONADO DA SILVA", ant: 592, lotacao: "3¬∫ CRBM-10¬∞ BBM-Ros√°rio do Sul" },
            { id: "4550455", nome: "RODRIGO LOPES BERNARDES", ant: 594, lotacao: "4¬∞ CRBM-6¬∫ BBM - Vera Cruz" },
            { id: "4550285", nome: "NATAN RODRIGUES SCIASCIA", ant: 595, lotacao: "4¬∞ CRBM-6¬∫ BBM Santa Cruz do Sul" },
            { id: "4550080", nome: "GABRIELA VASCONCELOS PEREIRA", ant: 596, lotacao: "AODC - Porto Alegre" },
            { id: "4550331", nome: "LEONARDO FUCK D√ÅVILA", ant: 597, lotacao: "2¬∫ CRBM-2¬∫ BBM - Campo Bom" },
            { id: "4550382", nome: "MARI√âLE LEANDRO DE LIMA", ant: 599, lotacao: "3¬∫ CRBM-10¬∞ BBM - S√£o Gabriel" },
            { id: "4552334", nome: "MONICA STUKER", ant: 602, lotacao: "AODC - Porto Alegre" },
            { id: "4552253", nome: "ŒïŒùŒñŒü Œ§ŒïŒôŒßEIRA MARTINS", ant: 603, lotacao: "2¬∫ CRBM-2¬∞ BBM - Novo Hamburgo" },
            { id: "4552342", nome: "VITOR RODRIGUES LEMKE", ant: 604, lotacao: "1¬∫ CRBM-8¬∞ BBM - Alvorada" },
            { id: "4595238", nome: "LUCAS MIETLICKI MARTINS", ant: 606, lotacao: "2¬∫ CRBM-2¬∫ BBM - Parob√©" },
            { id: "4278682", nome: "NAIANY CANABARRO CIELO", ant: 607, lotacao: "1¬∫ CRBM-BBS - Porto Alegre" },
            { id: "4626290", nome: "MAURICIO LOPES DORES", ant: 608, lotacao: "1¬∫ CRBM-1¬∫ BBM - Porto Alegre" },
            { id: "4626036", nome: "GABRIEL ANDRE SCHEIN", ant: 610, lotacao: "2¬∫ CRBM-5¬∞ BBM - Farroupilha" },
            { id: "4626680", nome: "THOMAZ LUIZ PIMENTEL", ant: 611, lotacao: "4¬∞ CRBM-12¬∞ BBM Ibirub√°" },
            { id: "4625617", nome: "JONATAS HOEFLING DIAS", ant: 612, lotacao: "2¬∫ CRBM-5¬∞ BBM - Farroupilha" },
            { id: "4625552", nome: "MORGANA FATIMA PEREIRA", ant: 613, lotacao: "4¬∞ CRBM-11¬∫ BBM-Horizontina" },
            { id: "4627059", nome: "DANUSA MUNARI FERENZ", ant: 614, lotacao: "2¬∫ CRBM-7¬∞ BBM - Erechim" },
            { id: "4625986", nome: "IZELEO DE PELLEGRIN JUNIOR", ant: 615, lotacao: "4¬∞ CRBM -6¬∞ BBM - Taquari" },
            { id: "4626540", nome: "BRUNO COPPETTI PERLIN", ant: 616, lotacao: "4¬∫ CRBM-11¬∞ BBM - Santo √Çngelo" },
            { id: "4625650", nome: "STEVEN VAN HATTEM", ant: 617, lotacao: "2¬∫ CRBM-2¬∫ BBM - Dois Irm√£os" },
            { id: "4625480", nome: "PETERSON LUIS WOLF", ant: 618, lotacao: "1¬∫ CRBM-8¬∞ BBM - Sapucaia do Sul" },
            { id: "4626478", nome: "WESLEY TREVISOL MANICA", ant: 620, lotacao: "4¬∞ CRBM-6¬∞ BBM - Lajeado" },
            { id: "4625749", nome: "RAFAEL ZANCHETTIN", ant: 621, lotacao: "2¬∫ CRBM-5¬∞ BBM - Flores da Cunha" },
            { id: "4625536", nome: "FELIPE VOLKWEIS", ant: 622, lotacao: "2¬∫ CRBM-2¬∫ BBM - Dois Irm√£os" },
            { id: "4626052", nome: "LEONARDO ZILIO", ant: 623, lotacao: "2¬∫ CRBM-7¬∞ BBM - Guapor√©" },
            { id: "4626419", nome: "ADAUTO CESAR ACUNHA SARAIVA", ant: 625, lotacao: "4¬∫ CRBM-4¬∞ BBM - S√£o Sep√©" },
        ];

        // --- CONFIGURA√á√ÉO FIREBASE (GITHUB PAGES) ---
        const firebaseConfig = {
            apiKey: "AIzaSyAimXQSU5WX69hoEk02l4Q4YeQ-vMCi2xY",
            authDomain: "vagas-ctsp-2026.firebaseapp.com",
            projectId: "vagas-ctsp-2026",
            storageBucket: "vagas-ctsp-2026.firebasestorage.app",
            messagingSenderId: "336019414677",
            appId: "1:336019414677:web:45726517bcd4b82077859c"
        };
        
        let appId = 'cbmrs-movimentacao-2026';

        try {
            if (typeof window.__firebase_config !== 'undefined') {
                firebaseConfig = JSON.parse(window.__firebase_config);
                appId = window.__app_id || appId;
            }
        } catch (e) { console.error("Erro ao ler config:", e); }

        const ConfigWarning = () => (
            <div className="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 text-white p-8">
                <div className="bg-gray-800 p-8 rounded-xl max-w-2xl w-full border border-yellow-500 shadow-2xl text-center">
                    <h2 className="text-3xl font-bold mb-4 text-yellow-400">Configura√ß√£o Necess√°ria</h2>
                    <p className="mb-6 text-gray-300">Erro de configura√ß√£o do Firebase.</p>
                    <button onClick={() => window.location.reload()} className="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-6 rounded transition">Recarregar</button>
                </div>
            </div>
        );

        if (!firebaseConfig.apiKey) {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<ConfigWarning />);
            throw new Error("Firebase Config ausente.");
        }

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- COMPONENTE DE √çCONE ---
        const ICONS = {
            "user": <><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>,
            "search": <><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></>,
            "map-pin": <><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></>,
            "save": <><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></>,
            "bar-chart-2": <><line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/></>,
            "check-circle": <><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></>,
            "alert-octagon": <><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></>,
            "shield": <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/>,
            "log-out": <><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></>,
            "list": <><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></>,
            "alert-triangle": <><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></>
        };

        const Icon = ({ name, size = 24, className = "" }) => {
            const content = ICONS[name];
            if (!content) return null;
            return (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {content}
                </svg>
            );
        };

        function App() {
            const [user, setUser] = useState(null);
            const [selectedSergeant, setSelectedSergeant] = useState(null);
            const [searchQuery, setSearchQuery] = useState("");
            const [selectedCity, setSelectedCity] = useState("");
            const [allSelections, setAllSelections] = useState([]);
            const [saving, setSaving] = useState(false);
            const [showPending, setShowPending] = useState(false);
            const [showExcedentes, setShowExcedentes] = useState(false);

            useEffect(() => {
                const initAuth = async () => {
                    try { await signInAnonymously(auth); } catch (error) { console.error("Erro na autentica√ß√£o:", error); }
                };
                initAuth();
                const unsubscribe = onAuthStateChanged(auth, setUser);
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (!user) return;
                const q = query(collection(db, 'artifacts', appId, 'public', 'data', 'intencoes_2026'));
                const unsubscribe = onSnapshot(q, (snapshot) => {
                    const data = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setAllSelections(data);
                }, (error) => console.error("Erro ao ler dados:", error));
                return () => unsubscribe();
            }, [user]);

            useEffect(() => {
                if (selectedSergeant && allSelections.length > 0) {
                    const mySelection = allSelections.find(s => s.id === selectedSergeant.id);
                    setSelectedCity(mySelection ? mySelection.cidade : "");
                }
            }, [selectedSergeant, allSelections]);

            // L√≥gica de Classifica√ß√£o
            const getMyStatus = () => {
                if (!selectedCity || !selectedSergeant) return null;
                const competitors = allSelections.filter(s => s.cidade === selectedCity);
                const amISaved = competitors.find(s => s.id === selectedSergeant.id);
                let allCompetitors = [...competitors];
                if (!amISaved) {
                    allCompetitors.push({ id: selectedSergeant.id, nome: selectedSergeant.nome, antiguidade: Number(selectedSergeant.ant), cidade: selectedCity });
                }
                allCompetitors.sort((a, b) => Number(a.antiguidade) - Number(b.antiguidade));
                const myRank = allCompetitors.findIndex(s => s.id === selectedSergeant.id) + 1;
                const cityData = VAGAS_DATA.find(v => v.cidade === selectedCity);
                const cityVagas = cityData?.vagas || 0;
                const isNoChoice = selectedCity === "N√£o irei escolher";
                return { rank: myRank, vagas: cityVagas, isIn: isNoChoice ? true : myRank <= cityVagas, totalCompetitors: allCompetitors.length, isNoChoice: isNoChoice };
            };

            const myStatus = useMemo(() => getMyStatus(), [selectedCity, allSelections, selectedSergeant]);

            // C√°lculos para o Status Geral
            const totalSargentos = SARGENTOS_DATA.length;
            const totalInscritos = allSelections.length;
            const totalFaltam = totalSargentos - totalInscritos;

            // Lista de Pendentes (Quem n√£o est√° no allSelections)
            const pendingList = useMemo(() => {
                const registeredIds = new Set(allSelections.map(s => s.id));
                return SARGENTOS_DATA.filter(s => !registeredIds.has(s.id)).sort((a,b) => a.ant - b.ant);
            }, [allSelections]);

            // Lista de Excedentes (Quem escolheu mas est√° fora das vagas)
            const excedentesList = useMemo(() => {
                let excedentes = [];
                // Agrupar por cidade
                const cityGroups = {};
                allSelections.forEach(sel => {
                    if (!cityGroups[sel.cidade]) cityGroups[sel.cidade] = [];
                    cityGroups[sel.cidade].push(sel);
                });

                // Verificar em cada cidade
                Object.keys(cityGroups).forEach(cidade => {
                    if (cidade === "N√£o irei escolher") return;
                    const vagaInfo = VAGAS_DATA.find(v => v.cidade === cidade);
                    if (!vagaInfo) return;
                    
                    const inscritos = cityGroups[cidade].sort((a,b) => a.antiguidade - b.antiguidade);
                    if (inscritos.length > vagaInfo.vagas) {
                        // Pegar os que est√£o depois do limite de vagas
                        const fora = inscritos.slice(vagaInfo.vagas);
                        excedentes = [...excedentes, ...fora];
                    }
                });
                return excedentes.sort((a,b) => a.antiguidade - b.antiguidade);
            }, [allSelections]);


            const handleSave = async () => {
                if (!user || !selectedSergeant || !selectedCity) return;
                setSaving(true);
                try {
                    const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'intencoes_2026', selectedSergeant.id);
                    await setDoc(docRef, { nome: selectedSergeant.nome, idFunc: selectedSergeant.id, antiguidade: Number(selectedSergeant.ant), lotacaoAtual: selectedSergeant.lotacao, cidade: selectedCity, timestamp: new Date().toISOString() });
                } catch (e) { console.error(e); alert("Erro ao salvar."); } finally { setSaving(false); }
            };

            const filteredSargentos = SARGENTOS_DATA.filter(s => s.nome.toLowerCase().includes(searchQuery.toLowerCase()) || s.id.includes(searchQuery));

            if (!selectedSergeant) {
                return (
                    <div className="min-h-screen bg-gray-100 flex items-center justify-center p-4">
                        <div className="bg-white rounded-xl shadow-xl max-w-md w-full p-8">
                            <div className="text-center mb-8">
                                <div className="bg-red-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"><Icon name="user" className="text-white" /></div>
                                <h1 className="text-2xl font-bold text-gray-800">Sistema de Movimenta√ß√£o</h1>
                                <p className="text-gray-500">Acesso por Antiguidade</p>
                            </div>
                            <div className="space-y-4">
                                <div className="relative">
                                    <span className="absolute left-3 top-3 text-gray-400"><Icon name="search" size={20} /></span>
                                    <input type="text" placeholder="Buscar por Nome ou ID..." className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} />
                                </div>
                                <div className="h-64 overflow-y-auto border border-gray-200 rounded-lg bg-gray-50 custom-scrollbar">
                                    {filteredSargentos.map(s => (
                                        <button key={s.id} onClick={() => setSelectedSergeant(s)} className="w-full text-left p-3 hover:bg-red-50 border-b last:border-0 transition-colors">
                                            <span className="font-medium text-gray-800 block">{s.nome}</span>
                                            <span className="text-xs text-gray-600">Antiguidade: <b>{s.ant}</b></span>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50 flex flex-col">
                    <header className="bg-red-700 text-white shadow-lg sticky top-0 z-10">
                        <div className="container mx-auto px-4 py-3 flex justify-between items-center">
                            <div className="flex items-center space-x-2"><Icon name="shield" className="text-white" /><div><div className="font-bold leading-none">Movimenta√ß√£o 2026</div><div className="text-xs opacity-80 font-light">Crit√©rio: Antiguidade</div></div></div>
                            <div className="flex items-center space-x-4"><div className="text-right hidden sm:block"><div className="text-sm font-bold">{selectedSergeant.nome}</div><div className="text-xs bg-red-800 px-2 py-0.5 rounded inline-block">Antiguidade: {selectedSergeant.ant}</div></div><button onClick={() => {setSelectedSergeant(null); setSelectedCity("");}} className="p-2 hover:bg-red-800 rounded-lg"><Icon name="log-out" size={20} /></button></div>
                        </div>
                    </header>

                    <main className="flex-1 container mx-auto px-4 py-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-1 space-y-6">
                            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                <h2 className="text-lg font-bold text-gray-800 mb-4 flex items-center"><span className="mr-2 text-red-600"><Icon name="map-pin" size={20} /></span>Sua Escolha</h2>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Cidade Desejada</label>
                                        <select value={selectedCity} onChange={(e) => setSelectedCity(e.target.value)} className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none bg-white">
                                            <option value="">Selecione...</option>
                                            {VAGAS_DATA.map(v => (<option key={v.cidade} value={v.cidade}>{v.cidade} ({v.vagas === 9999 ? 'Sem limite' : v.vagas + ' vagas'})</option>))}
                                        </select>
                                    </div>
                                    {selectedCity && myStatus && (
                                        <div className={`p-4 rounded-lg border-l-4 shadow-sm transition-all duration-300 ${myStatus.isIn ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                                            <div className="flex items-start justify-between mb-2">
                                                <h3 className={`text-sm font-bold uppercase ${myStatus.isIn ? 'text-green-800' : 'text-red-800'}`}>{myStatus.isNoChoice ? 'Op√ß√£o Registrada' : (myStatus.isIn ? 'Classificado' : 'Excedente')}</h3>
                                                {myStatus.isIn ? <Icon name="check-circle" size={18} className="text-green-600" /> : <Icon name="alert-octagon" size={18} className="text-red-600" />}
                                            </div>
                                            <div className="space-y-1">
                                                {myStatus.isNoChoice ? (<p className="text-sm text-gray-700">Voc√™ optou por n√£o concorrer a nenhuma vaga espec√≠fica.</p>) : (
                                                    <><p className="text-sm text-gray-700">Sua posi√ß√£o: <strong className="text-lg">{myStatus.rank}¬∫</strong> de {myStatus.vagas} vagas</p>
                                                    {!myStatus.isIn && (<p className="text-xs text-red-700 font-medium mt-2 animate-pulse-slow">‚ö†Ô∏è Militares mais antigos ocuparam as vagas. Voc√™ deve escolher outra cidade.</p>)}
                                                    {myStatus.isIn && (<p className="text-xs text-green-700 mt-1">Voc√™ est√° dentro do n√∫mero de vagas pela sua antiguidade ({selectedSergeant.ant}).</p>)}</>
                                                )}
                                            </div>
                                        </div>
                                    )}
                                    <button onClick={handleSave} disabled={!selectedCity || saving} className={`w-full py-3 rounded-lg flex items-center justify-center space-x-2 font-medium text-white transition-all ${!selectedCity || saving ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700 shadow-md'}`}>
                                        {saving ? <span>Salvando...</span> : <><Icon name="save" size={20} /><span>Confirmar Interesse</span></>}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="lg:col-span-2 space-y-6">
                            {/* QUADRO DE STATUS GERAL (NOVO) */}
                            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                                <h2 className="text-lg font-bold text-gray-800 mb-4 flex items-center">
                                    <span className="mr-2 text-blue-600"><Icon name="bar-chart-2" size={20} /></span>Status do Processo
                                </h2>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                    <div className="bg-blue-50 p-3 rounded-lg text-center">
                                        <div className="text-2xl font-bold text-blue-700">{totalInscritos}</div>
                                        <div className="text-xs text-blue-600 font-medium uppercase">Preencheram</div>
                                    </div>
                                    <div className="bg-orange-50 p-3 rounded-lg text-center">
                                        <div className="text-2xl font-bold text-orange-700">{totalFaltam}</div>
                                        <div className="text-xs text-orange-600 font-medium uppercase">Faltam</div>
                                    </div>
                                    <div className="bg-red-50 p-3 rounded-lg text-center cursor-pointer hover:bg-red-100 transition" onClick={() => setShowExcedentes(!showExcedentes)}>
                                        <div className="text-2xl font-bold text-red-700">{excedentesList.length}</div>
                                        <div className="text-xs text-red-600 font-medium uppercase flex items-center justify-center gap-1">Excedentes <Icon name="list" size={12}/></div>
                                    </div>
                                    <div className="bg-gray-100 p-3 rounded-lg text-center cursor-pointer hover:bg-gray-200 transition" onClick={() => setShowPending(!showPending)}>
                                        <div className="text-2xl font-bold text-gray-700">{pendingList.length}</div>
                                        <div className="text-xs text-gray-600 font-medium uppercase flex items-center justify-center gap-1">Ver Lista <Icon name="list" size={12}/></div>
                                    </div>
                                </div>

                                {/* LISTA DE EXCEDENTES (EXPANS√çVEL) */}
                                {showExcedentes && (
                                    <div className="mb-4 border-t border-red-100 pt-4 bg-red-50 rounded-lg p-4">
                                        <h3 className="text-sm font-bold text-red-800 mb-2 flex items-center"><Icon name="alert-triangle" size={16} className="mr-1"/> Aten√ß√£o: Militares que precisam trocar de op√ß√£o</h3>
                                        <div className="max-h-40 overflow-y-auto custom-scrollbar">
                                            {excedentesList.length === 0 ? <p className="text-sm text-gray-500">Nenhum excedente no momento.</p> : (
                                                <ul className="space-y-1">
                                                    {excedentesList.map(exc => (
                                                        <li key={exc.id} className="text-xs text-red-700 flex justify-between border-b border-red-200 py-1">
                                                            <span><b>{exc.antiguidade}</b> - {exc.nome}</span>
                                                            <span className="italic opacity-75">{exc.cidade}</span>
                                                        </li>
                                                    ))}
                                                </ul>
                                            )}
                                        </div>
                                    </div>
                                )}

                                {/* LISTA DE PENDENTES (EXPANS√çVEL) */}
                                {showPending && (
                                    <div className="mb-4 border-t border-gray-100 pt-4">
                                        <h3 className="text-sm font-bold text-gray-700 mb-2">Quem ainda n√£o preencheu:</h3>
                                        <div className="max-h-60 overflow-y-auto custom-scrollbar grid grid-cols-1 md:grid-cols-2 gap-2">
                                            {pendingList.map(p => (
                                                <div key={p.id} className="text-xs text-gray-600 bg-gray-50 p-2 rounded border border-gray-100 flex flex-col justify-center">
                                                    <div>
                                                        <span className="font-bold text-gray-800 mr-2">{p.ant}</span> 
                                                        <span className="font-medium">{p.nome}</span>
                                                    </div>
                                                    <div className="text-[10px] text-gray-400 mt-1 italic pl-6 flex items-center">
                                                        <span className="mr-1">üìç</span> {p.lotacao}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col h-full">
                                <div className="p-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center">
                                    <h2 className="text-lg font-bold text-gray-800 flex items-center"><span className="mr-2 text-red-600"><Icon name="bar-chart-2" size={20} /></span>Quadro Geral de Ocupa√ß√£o</h2>
                                </div>
                                <div className="overflow-x-auto flex-1">
                                    <table className="w-full text-left text-sm">
                                        <thead className="bg-gray-100 text-gray-600 uppercase text-xs sticky top-0 z-0">
                                            <tr>
                                                <th className="p-3 font-semibold">Cidade</th>
                                                <th className="p-3 text-center">Vagas</th>
                                                <th className="p-3 text-center">Inscritos</th>
                                                <th className="p-3 text-left">Classificados</th>
                                                <th className="p-3 text-center">Situa√ß√£o</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-100">
                                            {VAGAS_DATA.map(vaga => {
                                                const inscritos = allSelections.filter(s => s.cidade === vaga.cidade);
                                                const count = inscritos.length;
                                                const sortedInscritos = [...inscritos].sort((a,b) => a.antiguidade - b.antiguidade);
                                                const lastIn = sortedInscritos[vaga.vagas - 1];
                                                const isNoChoice = vaga.cidade === "N√£o irei escolher";
                                                const ocupantes = isNoChoice ? sortedInscritos : sortedInscritos.slice(0, vaga.vagas);

                                                return (
                                                    <tr key={vaga.cidade} className="hover:bg-gray-50 align-top">
                                                        <td className="p-3 font-medium text-gray-800">{vaga.cidade}</td>
                                                        <td className="p-3 text-center font-bold">{isNoChoice ? '-' : vaga.vagas}</td>
                                                        <td className="p-3 text-center"><span className={`px-2 py-1 rounded-full text-xs font-bold ${!isNoChoice && count > vaga.vagas ? 'bg-red-100 text-red-700' : 'bg-blue-50 text-blue-700'}`}>{count}</span></td>
                                                        <td className="p-3 text-xs">
                                                            <div className="max-h-24 overflow-y-auto custom-scrollbar pr-1">
                                                                {ocupantes.length === 0 ? <span className="text-gray-400">-</span> : (ocupantes.map((occ, idx) => (<div key={occ.id} className="truncate text-gray-700 border-b border-gray-100 last:border-0 py-0.5" title={`${occ.nome} (Ant: ${occ.antiguidade})`}><span className="font-bold text-xs w-8 inline-block text-right mr-1">{occ.antiguidade}</span> {occ.nome.split(' ')[0]} {occ.nome.split(' ').length > 1 ? occ.nome.split(' ').pop() : ''}</div>)))}
                                                            </div>
                                                        </td>
                                                        <td className="p-3 text-center text-xs">
                                                            {isNoChoice ? (<span className="text-gray-500">Sem limite</span>) : (count > vaga.vagas ? (<div><span className="text-red-600 font-bold block">Disputado</span><span className="text-gray-400 text-[10px]">Corte: Ant. {lastIn?.antiguidade}</span></div>) : (<span className="text-green-600">Dispon√≠vel</span>))}
                                                        </td>
                                                    </tr>
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
